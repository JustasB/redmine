<div class="container">
<% if not User.current.logged? %>

<!-- HEADER -->
<!--
<div id="myCarousel" class="carousel slide">
	<ol class="carousel-indicators">
		<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
		<li data-target="#myCarousel" data-slide-to="1"></li>
		<li data-target="#myCarousel" data-slide-to="2"></li>
	</ol>
	<div class="carousel-inner">
		<div class="item active">
			<img src="/images/worm.png" alt="">
			<div class="carousel-caption">
				<h4>First Thumbnail label</h4>
				<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
			</div>
		</div>
		<div class="item">
			<img src="/images/purkinjee.png" alt="">
			<div class="carousel-caption">
				<h4>Second Thumbnail label</h4>
				<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
			</div>
		</div>
		<div class="item">
			<img src="/images/drosophila.png" alt="">
			<div class="carousel-caption">
				<h4>Third Thumbnail label</h4>
				<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
			</div>
		</div>
	</div>
	<a class="left carousel-control" href="#myCarousel" data-slide="prev">&lsaquo;</a>
	<a class="right carousel-control" href="#myCarousel" data-slide="next">&rsaquo;</a>
</div>
-->
	
<p class="big-lead pagination-centered"><strong>Open Source Brain</strong> is a resource for sharing and collaboratively developing computational models of neural systems</p>
<div id="osbcircle"></div>
<!--
<div id="quick-search">
	<%= form_tag({:controller => 'search', :action => 'index', :id => @project}, :method => :get ) do %>
	<%= hidden_field_tag(controller.default_search_scope, 1, :id => nil) if controller.default_search_scope %>
	<%= text_field_tag 'q', @question, :size => 70, :placeholder=>'Search Open Source Brain',:type=>'search', :results=>5, :class => 'large', :accesskey => accesskey(:quick_search) %>
	<% end %>
</div>
-->

            
<div class="row-fluid pagination-centered">
	<p>
	<a class="btn btn-xlarge btn-info" href="/projects">
		Explore OSB
	</a> 
	  
	<a class="btn btn-xlarge btn-success" href="/account/register">
		Sign up
	</a>
	</p>
</div>
	


<% else %>

	<!-- HEADER -->
	
	
		<h1>Hi <%= User.current.firstname %> </h1>
		<p class="lead">
			Welcome back!
		</p>
	
	<!-- CONTENT -->
	
	<div class="splitcontentleft">
		<div id="explorebutton" onclick="location.href='/projects';">
			Explore Open Source Brain
		</div>
		<div class="news box">
			<h3><%= l(:label_news_latest)%></h3>
			<% if @news.any? %>
			<%= render :partial => 'news/news', :collection => @news %>
			<%= link_to l(:label_news_view_all), :controller => 'news' %>
			<% end %>
		</div>
	
		<% if @projects.any? %>
		<div class="projects box">
			<h3>Latest projects added on OSB</h3>
			<ul>
				<% maxprjcount=3 %>
				<% i=0 %>
				<% for project in @projects %>
				<%if(i<maxprjcount)%>
					<% @project = project %>
					<% i=i+1 %>
					<li>
						<%= link_to_project project %> (<%= format_time(project.created_on) %>)
					</li>
					<% else break;%>
					<% end %>
					<% end %>
					<% @project = nil %>
			</ul>
		</div>
		<% end %>
	</div>
	
	<div class="splitcontentright">
	
		<div id="quick-search">
			<%= form_tag({:controller => 'search', :action => 'index', :id => @project}, :method => :get ) do %>
			<%= hidden_field_tag(controller.default_search_scope, 1, :id => nil) if controller.default_search_scope %>
			<%= text_field_tag 'q', @question, :size => 70, :placeholder=>'Search Open Source Brain',:type=>'search', :results=>5, :class => 'large', :accesskey => accesskey(:quick_search) %>
			<% end %>
		</div>
	
		<% unless @events_by_day.empty? %>
		<div class="issues box">
			<h3><%= link_to l(:label_activity), :controller => 'activities', :action => 'index', :id => nil, :user_id => @user, :from => @events_by_day.keys.first %></h3>
			<p>
				<%= l(:label_reported_issues)%>: <%= Issue.count(:conditions => ["author_id=?", @user.id]) %>
			</p>
			<div id="activity">
				<% @events_by_day.keys.sort.reverse.each do |day| %>
				<h4><%= format_activity_day(day) %></h4>
				<dl>
					<% @events_by_day[day].sort {|x,y| y.event_datetime <=> x.event_datetime }.each do |e| -%>
					<dt class="<%= e.event_type %>">
						<span class="time"><%= format_time(e.event_datetime, false) %></span>
						<%= content_tag('span', h(e.project), :class => 'project') %>
						<%= link_to format_activity_title(e.event_title), e.event_url %>
					</dt>
					<dd>
						<span class="description"><%= format_activity_description(e.event_description) %></span>
					</dd>
					<% end -%>
				</dl>
				<% end -%>
			</div>
		</div>
		<% end %>
	
		<div class="projects box">
			<h3>Your projects</h3>
			<% if @projects.any? %>
			<%= call_hook(:view_welcome_index_left, :projects => @projects) %>
			<% unless @memberships.empty? %>
			<ul>
				<% for membership in @memberships %>
				<li>
					<%= link_to_project(membership.project) %>
					(<%= h membership.roles.sort.collect(&:to_s).join(', ') %>, <%= format_date(membership.created_on) %>)
				</li>
				<% end %>
			</ul>
			<% end %>
			<% end %>
		</div>
	</div>
	
	<% content_for :header_tags do %>
	<%= stylesheet_link_tag 'scm' %>
	<%= auto_discovery_link_tag(:atom, {:controller => 'news', :action => 'index', :key => User.current.rss_key, :format => 'atom'},:title => "#{Setting.app_title}: #{l(:label_news_latest)}") %>
	<%= auto_discovery_link_tag(:atom, {:controller => 'activities', :action => 'index', :key => User.current.rss_key, :format => 'atom'},:title => "#{Setting.app_title}: #{l(:label_activity)}") %>
	<% end %>
<% end %>

</div>