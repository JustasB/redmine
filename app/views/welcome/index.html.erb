<div class="container">
<% if not User.current.logged? %>

<!-- HEADER -->
<!--
<div id="myCarousel" class="carousel slide">
	<ol class="carousel-indicators">
		<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
		<li data-target="#myCarousel" data-slide-to="1"></li>
		<li data-target="#myCarousel" data-slide-to="2"></li>
	</ol>
	<div class="carousel-inner">
		<div class="item active">
			<img src="/images/worm.png" alt="">
			<div class="carousel-caption">
				<h4>First Thumbnail label</h4>
				<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
			</div>
		</div>
		<div class="item">
			<img src="/images/purkinjee.png" alt="">
			<div class="carousel-caption">
				<h4>Second Thumbnail label</h4>
				<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
			</div>
		</div>
		<div class="item">
			<img src="/images/drosophila.png" alt="">
			<div class="carousel-caption">
				<h4>Third Thumbnail label</h4>
				<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
			</div>
		</div>
	</div>
	<a class="left carousel-control" href="#myCarousel" data-slide="prev">&lsaquo;</a>
	<a class="right carousel-control" href="#myCarousel" data-slide="next">&rsaquo;</a>
</div>
-->
	
<p class="big-lead pagination-centered"><strong>Open Source Brain</strong> is a resource for sharing and collaboratively developing computational models of neural systems</p>
<div id="osbcircle"></div>
<!--
<div id="quick-search">
	<%= form_tag({:controller => 'search', :action => 'index', :id => @project}, :method => :get ) do %>
	<%= hidden_field_tag(controller.default_search_scope, 1, :id => nil) if controller.default_search_scope %>
	<%= text_field_tag 'q', @question, :size => 70, :placeholder=>'Search Open Source Brain',:type=>'search', :results=>5, :class => 'large', :accesskey => accesskey(:quick_search) %>
	<% end %>
</div>
-->

            
<div class="row-fluid pagination-centered">
	<p>
	<a class="btn btn-xlarge btn-info" href="/projects">
		Explore OSB
	</a> 
	  
	<a class="btn btn-xlarge btn-success" href="/account/register">
		Sign up
	</a>
	</p>
</div>
	


<% else %>

	<!-- HEADER -->
	<br/></br/>
	<div class="span12 pagination-centered">
		<p class="lead">
			Hello  <%= User.current.firstname %>, welcome back.
		</p>
	</div>
	<p class="pagination-right">
		<button type="button" class="btn btn-large btn-info" onclick="location.href='/projects';">
			Explore OSB
		</button>
	</p>


	<!-- CONTENT -->
	<div class="row-fluid">
		<div class="span8">
			<% unless @events_by_day.empty? %>
					<div id="activity">
						<% @actID=0 %>
						<% @events_by_day.keys.sort.reverse.each do |day| %>
							<% @actID=@actID+1 %>
							<div class="row-fluid activity-item">
							<% @events_by_day[day].sort {|x,y| y.event_datetime <=> x.event_datetime }.each do |e| -%>
								<% @actID=@actID+1 %>
									<div class="row-fluid activity-item">
								  		<div class="span05 <%= "E_"+e.event_type %> <%= User.current.logged? && e.respond_to?(:event_author) && User.current == e.event_author ? 'me' : nil %>"></div>
								  		<div class="span11">
								  			<div class="time row-fluid" id="<%= 'T'+@actID.to_s() %>"><%= javascript_tag "jQuery('#{'#T'+@actID.to_s()}').html(moment('#{e.event_datetime}', 'YYYY-MM-DD HH:mm:ss Z').fromNow());" %></div>
								  			<div class="author row-fluid"><strong><%= link_to_user(e.event_author) if e.respond_to?(:event_author) %> edited
								  			
								  			<%= content_tag('span', h(e.project), :class => 'project-title') if @project.nil? || @project != e.project %></strong></div>
								  			<div class="row-fluid">
								  			<%= avatar(e.event_author, :size => "50", :class => "img-rounded") if e.respond_to?(:event_author) %>
								  			<%= link_to format_activity_title(e.event_title), e.event_url %>
								  			</div>
								  			<div class="row-fluid">
								  				<div class="description"><%= format_activity_description(e.event_description) %></div>
							  				</div>
							  			</div>
									</div>
								<% end -%>
							</div>
						<% end -%>
					</div>
				</div>
			<% end %>

		<div class="span4">
			<table class="projecttable table">
				<thead>
					<tr>
						<td><h4>Your projects </h4></td>
						<td class="noborder pull-right"><button type="button" class="btn btn-success icon-plus"  onclick="location.href='/projects/new';"> New project</button></td> 	
					<tr>
				</thead>
				<% if @projects.any? %>
					<%= call_hook(:view_welcome_index_left, :projects => @projects) %>
					<% unless @memberships.empty? %>
						
							<% for membership in @memberships %>
								<tr><td colspan="2"><icon class=" icon-list-alt"></icon><%= link_to_project(membership.project) %></td></tr>
							<% end %>
						
					<% end %>
				<% end %>
			</table>
			
			
			<table class="projecttable table">
				<thead>
					<tr>
						<td><h4>Latest projects added on OSB</h4></td> 	
					<tr>
				</thead>
					<% maxprjcount=3 %>
					<% i=0 %>
					<% for project in @projects %>
						<%if(i<maxprjcount)%>
							<% @project = project %>
							<% i=i+1 %>
								<tr><td><icon class=" icon-list-alt"></icon> <%= link_to_project project %></td></tr> 
						<% else break;%>
						<% end %>
					<% end %>
					<% @project = nil %>
			</table>
			
				<div>
		<div class="news box">
			<div class="pagination-centered"><icon class="icon-bullhorn icon-xxlarge"></icon></div>
			<h3><%= l(:label_news_latest)%></h3>
			<% if @news.any? %>
			<%= render :partial => 'news/news', :collection => @news %>
			<%= link_to l(:label_news_view_all), :controller => 'news' %>
			<% end %>
		</div>
	</div>
			
		</div>
	</div>
	


		
	<% content_for :header_tags do %>
	<%= stylesheet_link_tag 'scm' %>
	<%= auto_discovery_link_tag(:atom, {:controller => 'news', :action => 'index', :key => User.current.rss_key, :format => 'atom'},:title => "#{Setting.app_title}: #{l(:label_news_latest)}") %>
	<%= auto_discovery_link_tag(:atom, {:controller => 'activities', :action => 'index', :key => User.current.rss_key, :format => 'atom'},:title => "#{Setting.app_title}: #{l(:label_activity)}") %>
	<% end %>
<% end %>

</div>